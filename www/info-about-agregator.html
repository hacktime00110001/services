<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<meta property="og:title" content="TaxiTime"> 
		<meta name="description" content="">
		<meta property="og:description" content=""> 
		<meta name="twitter:title" content="TaxiTime">
		<meta name="twitter:description" content="">

		<meta property="og:image" content="./imgs/favicon.jpg">
		<meta property="og:type" content="website">
		<meta property="og:url" content="">
		<meta property="og:site_name" content="SixTouchesTTaxiTimeeam">

		<link rel="shortcut icon" type="shortcut icon" href="./imgs/favicon.jpg">

		<link rel="stylesheet" href="./libs/bootstrap.min.css"> 

		<link rel="stylesheet" href="./css/fonts.css">
		<link rel="stylesheet" href="./css/main.css">
				
		<title>TaxiTime</title>
		
	</head>
<body ontouchstart="">
	   
	<header>
		<div class="container">
			<div class="row flex-column align-items-center">
				<div class="analyticsTitle">
					<img src="./imgs/registrationLogo.png" alt="TxT">
					<p class="mr-3"></p>
					<a href="homepage.html">
						<img class="back_to_homepage" src="./imgs/arrow_back.png" alt="Profile">
					</a>
				</div>
			</div>
		</div>
	</header>
	
	<main>
		<div class="container">
			<div class="row flex-column align-items-center" id="main_content">
				<div class="w-100 d-flex justify-content-center">
					<input id="agregatorSearchBtn" type="button" class="driverProfile_OrangeBtn w-130 mb-0 back_search">
					<div class="w-50 w-20_350"></div>
					<input data-toggle="modal" data-target="#modalFilter" type="button" class="driverProfile_OrangeBtn w-130 mb-0 back_filter">
				</div>
				<div class="w-100 d-flex justify-content-center">
					<form id="agregatorSearchContainer" class="argeratorSearch_Cont" method="post">
						<input class="argeratorSearch_input" type="text" placeholder="Поиск партнера">
						<input value type="submit" class="argeratorSearch_Submit driverProfile_OrangeBtn w-43 mb-0 mt-0 back_search">
					</form>
				</div>
				<div class="row w-100 p-15" id="contentPartners"></div>
				<input onclick="window.location.href='homepage.html'" type="button" class="driverProfile_OrangeBtn max-w-275 mt-15 mb-26" value="Назад">
			</div>
		</div>
	</main>  

	<!-- Modal -->
	<div class="modal fade" id="modalFilter" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	  <div class="modal-dialog modalFilter-dialog" role="document">
		<div class="modal-content modalThx-content">
		  <div class="modal-body">
			  <input type="button" class="close modalThx_closeBtn" data-dismiss="modal" aria-label="Close">
			  <p class="fw_bold fs_16 text-center">Фильтр</p>
			  <form class="w-100 d-flex flex-column">
				  <p class="fw_bold">Комиссии:</p>
				  <div class="d-flex">
					  <div class="d-flex align-items-center mr-3">
						  <div class="checkboxWhiteDiv checkboxWhiteOff">
							  <input class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);"/>
						  </div>
						  <p class="fw_medium fs_11 mt-1">1%</p>
					  </div>
					  <div class="d-flex align-items-center mr-3">
						  <div class="checkboxWhiteDiv checkboxWhiteOff">
							  <input class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);"/>
						  </div>
						  <p class="fw_medium fs_11 mt-1">2%</p>
					  </div>
					  <div class="d-flex align-items-center mr-3">
						  <div class="checkboxWhiteDiv checkboxWhiteOff">
							  <input class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);" />
						  </div>
						  <p class="fw_medium fs_11 mt-1">3%</p>
					  </div>
					  <div class="d-flex align-items-center mr-3">
						  <div class="checkboxWhiteDiv checkboxWhiteOff">
							  <input class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);" />
						  </div>
						  <p class="fw_medium fs_11 mt-1">4%</p>
					  </div>
					  <div class="d-flex align-items-center mr-3">
						  <div class="checkboxWhiteDiv checkboxWhiteOff">
							  <input class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);" />
						  </div>
						  <p class="fw_medium fs_11 mt-1">5%</p>
					  </div>
					  <div class="d-flex align-items-center">
						  <div class="checkboxWhiteDiv checkboxWhiteOff">
							  <input class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);" />
						  </div>
						  <p class="fw_medium fs_11 mt-1">6%</p>
					  </div>
				  </div>
				  <p class="fw_bold mt-15">Системы выплат:</p>
				  <div class="d-flex flex-column">
					  <div class="d-flex align-items-center mr-3">
						  <div class="checkboxWhiteDiv checkboxWhiteOff">
							  <input id="MOZEN" class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);"/>
						  </div>
						  <label class="mb-0" for="MOZEN">
							  <p class="fw_medium fs_11 mt-1 ml-1">MOZEN</p>
						  </label>
					  </div>
					  <div class="d-flex align-items-center mr-3">
						  <div class="checkboxWhiteDiv checkboxWhiteOff">
							  <input id="YANDEX" class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);" />
						  </div>
						  <label class="mb-0" for="YANDEX">
							  <p class="fw_medium fs_11 mt-1 ml-1">QIWI</p>
						  </label>
					  </div>
					  <div class="d-flex align-items-center mr-3">
						  <div class="checkboxWhiteDiv checkboxWhiteOff">
							  <input id="QIWI" class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);" />
						  </div>
						  <label class="mb-0" for="QIWI">
							  <p class="fw_medium fs_11 mt-1 ml-1">MOMENTUM</p>
						  </label>
					  </div>
					  <div class="d-flex align-items-center mr-3">
						  <div class="checkboxWhiteDiv checkboxWhiteOff">
							  <input id="QIWI" class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);" />
						  </div>
						  <label class="mb-0" for="QIWI">
							  <p class="fw_medium fs_11 mt-1 ml-1">Отсутсвует</p>
						  </label>
					  </div>
				  </div>
				  <p class="fw_bold mt-15">Каналы тех. поддержки:</p>
				  <div class="d-flex mt-10">
					  <div class="col30pr">
						  <div class="d-flex align-items-center mr-3">
							  <div class="checkboxWhiteDiv checkboxWhiteOff">
								  <input id="filterPhone" class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);" />
							  </div>
							  <label class="mb-0" for="filterPhone">
								  <img src="./imgs/channel_phone.png" alt="Phone">
							  </label>
						  </div>
					  </div>
					  <div class="col30pr">
						  <div class="d-flex align-items-center mr-3">
							  <div class="checkboxWhiteDiv checkboxWhiteOff">
								  <input id="filterTelegram" class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);" />
							  </div>
							  <label class="mb-0" for="filterTelegram">
								  <img src="./imgs/channel_telegram.png" alt="Telegram">
							  </label>
						  </div>
					  </div>
					  <div class="col30pr">
						  <div class="d-flex align-items-center mr-3">
							  <div class="checkboxWhiteDiv checkboxWhiteOff">
								  <input id="filterViber" class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);" />
							  </div>
							  <label class="mb-0" for="filterViber">
								  <img src="./imgs/channel_viber.png" alt="Viber">
							  </label>
						  </div>
					  </div>
				  </div>
				  <div class="d-flex mt-15">
					  <div class="col30pr">
						  <div class="d-flex align-items-center mr-3">
							  <div class="checkboxWhiteDiv checkboxWhiteOff">
								  <input id="filterWhatsApp" class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);" />
							  </div>
							  <label class="mb-0" for="filterWhatsApp">
								  <img src="./imgs/channel_whatsapp.png" alt="WhatsApp">
							  </label>
						  </div>
					  </div>
					  <div class="col30pr">
						  <div class="d-flex align-items-center mr-3">
							  <div class="checkboxWhiteDiv checkboxWhiteOff">
								  <input id="filterVk" class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);" />
							  </div>
							  <label class="mb-0" for="filterVk">
								  <img src="./imgs/channel_vk.png" alt="Vk">
							  </label>
						  </div>
					  </div>
					  <div class="col30pr">
						  <div class="d-flex align-items-center mr-3">
							  <div class="checkboxWhiteDiv checkboxWhiteOff">
								  <input id="filterMessage" class="numberCheakBox" type="checkbox" onclick="logincheckboxCheck(this);"/>
							  </div>
							  <label class="mb-0" for="filterMessage">
								  <img src="./imgs/channel_message.png" alt="Message">
							  </label>
						  </div>
					  </div>
				  </div>
				  <p class="fw_bold mt-15 mb-5">Рейтинг партнера:</p>
				  <div class="d-flex">
					  <label class="radioContainer">любой
						  <input type="radio" name="partners_rate" id="default_radio1" checked>
						  <span class="checkmark"></span>
					  </label>
					  <label class="radioContainer">более 3-х
						  <input type="radio" name="partners_rate">
						  <span class="checkmark"></span>
					  </label>
					  <label class="radioContainer">более 4-х
						  <input type="radio" name="partners_rate">
						  <span class="checkmark"></span>
					  </label>
				  </div>
				  <p class="fw_bold mt-15 mb-5">Парковые автомобили:</p>
				  <div class="d-flex">
					  <label class="radioContainer" style="margin-right: 35px;">все
						  <input type="radio" name="partners_park_Auto" id="default_radio2" checked>
						  <span class="checkmark"></span>
					  </label>
					  <label class="radioContainer" style="margin-right: 59px;"><img src="./imgs/parkCar_yes.png" alt="Message">
						  <input type="radio" name="partners_park_Auto">
						  <span class="checkmark"></span>
					  </label>
					  <label class="radioContainer"><img src="./imgs/parkCar_no.png" alt="Message">
						  <input type="radio" name="partners_park_Auto">
						  <span class="checkmark"></span>
					  </label>
				  </div>
				  <div class="d-flex justify-content-between">
					  <input type="button" class="driverProfile_OrangeBtn w-130 w-120_340 mb-10 fs_12" id="find_by_filter" value="Применить">
					  <input type="button" class="driverProfile_OrangeBtn w-130 w-120_340 mb-10 fs_12" id="clean_filter" value="Очистить фильтр">
				  </div>
			  </form>
		  </div>
		</div>
	  </div>
	</div>
	<script type="text/javascript" src="./libs/jquery.min.js"></script>
	<script type="text/javascript" src="./libs/bootstrap.min.js"></script>

	<script type="text/javascript" src="./js/modal.js"></script>
	
	<script>
		$store = localStorage;

		$.post("http://taxitime.pro/api/MainData.php", { 
			getInfoAboutAgregator: $store.getItem("lastVisitAgregator")
		}).done(function (data) {
			var agregatordata = JSON.parse(data);
			$content = $("#contentPartners");

			$(".analyticsTitle p").html(agregatordata[0].name);
			if(agregatordata[1].length != 0) { 
				for(i = 0; i < agregatordata[1].length; i++) {
					$content.append('<div class="w-100 p-5"><a href="./info-about-partner.html" data-parnter-id='+agregatordata[1][i].id+'><div class="analyticsBox"><div class="w-100 d-flex align-items-center justify-content-between"><p class="agregatorBox_name">'+agregatordata[1][i].name+'</p><p class="agregatorBox_rating">Рейтинг: <span id="reting" class="reting">'+agregatordata[1][i].rating+'</span></p></div><div class="w-100 row justify-content-between p-10"><div class="agregatorBox_conditions"><p class="agregatorBox_title">Условия работы</p><div class="agregatorBox_hr"></div><ul><li><img class="w-9 h-10 mr-10 mt-3" src="./imgs/agreratorBox_li.png" alt="&#10004;"><p class="fw_bold fs_20"><span>Комиссия парка - </span>'+agregatordata[1][i].park_commission+' %</p></li><li><img class="w-9 h-10 mr-10" src="./imgs/agreratorBox_li.png" alt="&#10004;"><div><p><span>Выплаты:</span></p><ul><li><p>'+agregatordata[1][i].payment_types+'</p></li></ul></div></li><li class="d-flex flex-column"><div class="d-flex"><img class="w-9 h-10 mr-10" src="./imgs/agreratorBox_li.png" alt="&#10004;"><p><span>Каналы тех. поддержки:</span></p></div><div class="agreratorBox_supportImgs" data-imgs-id=\''+i+'\'></div></li><li><img class="w-9 h-10 mr-10" src="./imgs/agreratorBox_li.png" alt="&#10004;"><p class="w-60"><span>Парковые автомобили:</span></p><div class="parkCar_Imgs" data-cars-id=\''+i+'\'></div></li></ul></div><div class="agregatorBox_agregators"><p class="agregatorBox_title">Агрегаторы</p><div class="agregatorBox_hr"></div><div class="row agregatorBox_agregatorsList" id="agregatorBox_agregatorsList" data-agregators-id=\''+i+'\'></div></div></div><input type="button" class="driverProfile_OrangeBtn max-w-275 mt-0 mb-5" value="Перейти"></div></a></div>');
					
					$chanelsContent = $(".agreratorBox_supportImgs[data-imgs-id='"+i+"']");
					for(j = 0; j < agregatordata[1][i][0].support_channels.length; j++)
						$chanelsContent.append("<img src='"+agregatordata[1][i][0].support_channels[j].logo_url+"' alt='"+agregatordata[1][i][0].support_channels[j].name+"'>");
					
					$cars = agregatordata[1][i].park_cars.split(";");
					if($cars[0] == "none")
						$(".parkCar_Imgs[data-cars-id='"+i+"']").append("<img src='./imgs/parkCar_no.png' alt='No'>");
					else
						$(".parkCar_Imgs[data-cars-id='"+i+"']").append("<img src='./imgs/parkCar_yes.png' alt='Yes'>");

					$agregatorsContent = $("#agregatorBox_agregatorsList[data-agregators-id='"+i+"']");
					for(j = 0; j < agregatordata[1][i][1].some_info_agregators.length; j++)
						$agregatorsContent.append("<div class='col30pr'><img src='"+agregatordata[1][i][1].some_info_agregators[j].logo_url+"' alt='"+agregatordata[1][i][1].some_info_agregators[j].name+"'></div>");
					
				}
			} else {
				$("#main_content").html('<div class="row analyticsContainer" style="height: 100vh;display: flex;align-content: center;"><h2 style="color: #333333; text-align: center;">У данного агрегатора нет партнеров!</h2></div>');
			}

			$("a").click(function () {
                attrValue = $(this).attr('data-parnter-id');
                if(attrValue != undefined) {
                    $store.setItem("lastVisitPartner", attrValue);
                }
            });

            retingUpdate();

		}).fail(function(xhr, textStatus, error) {
			modal_alert("Server error!", 2, "xhr.statusText: " + xhr.statusText + "<br>textStatus: " + textStatus + "<br>error: " + error + "<br>");
		});

	</script>

	<script>
		$("#agregatorSearchBtn").on("click", function() {
			$("#agregatorSearchContainer").fadeToggle("slow", "linear");
		}); 
		function logincheckboxCheck (inp) {
			inp.parentElement.classList.toggle("checkboxWhiteOff");
			inp.parentElement.classList.toggle("checkboxWhiteOn");
		}
	</script>

	<script type="text/javascript">
		function retingUpdate() {
			$high = "agrBox_rateGreen";
			$medium = "agrBox_rateYellow";
			$low = "agrBox_rateRed";

			$retingsBlock = document.querySelectorAll(".reting");
			$parents = document.querySelectorAll(".agregatorBox_rating");
			
			for(q = 0; q < $retingsBlock.length; q++) {
				$reting = parseFloat($retingsBlock[q].innerHTML);
				if($reting >= 4.5 && $reting <= 5.0)
					$parents[q].classList.add($high);
				else if($reting >= 4.0 && $reting < 4.5)
			 		$parents[q].classList.add($medium);
				else 
			 		$parents[q].classList.add($low);
			}
		}

	</script>

	<script type="text/javascript">
		$("#find_by_filter").click(function () {
			$('#modalFilter').modal('hide');
		});

		$("#clean_filter").click(function () {
			$("input[type='radio']").prop("checked", false);
			$("#default_radio1").prop("checked", true);
			$("#default_radio2").prop("checked", true);
			$("input[type='checkbox']").parent().removeClass("checkboxWhiteOff");
			$("input[type='checkbox']").parent().addClass("checkboxWhiteOn");
			$("input[type='checkbox']").prop("checked", true);
		});
	</script>

	</body>
</html>